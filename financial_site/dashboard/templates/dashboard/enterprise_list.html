{% extends 'dashboard/base.html' %}
{% block title %}–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è{% endblock %}

{% block content %}
<h2 class="mb-4">–°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π</h2>

<div class="row">
  {% for e in enterprises %}
  <div class="col-12 mb-4">
    <div class="card shadow-sm">
      <div class="card-header bg-light fw-bold">{{ e.name }}</div>

      <div class="card-body">
        <p><strong>–†–µ–∫–≤–∏–∑–∏—Ç—ã:</strong> {{ e.requisites }}</p>
        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ e.phone }}</p>
        <p><strong>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ:</strong> {{ e.contact_person }}</p>

        <div class="d-flex gap-2 mt-3">
          <a href="{% url 'indicator_values' %}?enterprise_id={{ e.id }}" class="btn btn-primary">
            üìä –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏
          </a>

          <button class="btn btn-secondary" type="button" data-bs-toggle="collapse"
                  data-bs-target="#weighted{{ e.id }}">
            ‚öñÔ∏è –í–∑–≤–µ—à–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
          </button>
        </div>

        <!-- –∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ -->
        <div class="collapse mt-3" id="weighted{{ e.id }}">
          <div class="border rounded p-3 bg-light">
            {% if e.weighted_sum %}
              <p class="fw-semibold mb-0">
                –°—É–º–º–∞ –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π: {{ e.weighted_sum }} RUB
              </p>
            {% else %}
              <p class="text-muted mb-0">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
